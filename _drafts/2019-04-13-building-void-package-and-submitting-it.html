---
layout: post
title: Building a void package and submitting it for inclusion in to  their repositories.
date: '2019-04-13T05:51:00.002-07:00'
author: "@eamoc"
tags: 
modified_time: '2019-04-13T05:51:49.290-07:00'
blogger_id: tag:blogger.com,1999:blog-6955428370236550107.post-8376632320506287582
blogger_orig_url: https://eamoc.blogspot.com/2019/04/building-void-package-and-submitting-it.html
---

I am trying to build openFrameworks on my void distribution.<br />It turns out that it requires a realtime audio package that doesn't exist. A perfect opportunity to package it up.<br /><br />First, clone the github repo at git hub.com/void-linux/void-packages.git<br /><br /><b>➜ cd void-packages/</b><br /><b>➜ git clone https://github.com/void-linux/void-packages.git</b><br /><br />Then cd into void-packages and run the xbps-src.sh script<br /><br /><b>&nbsp;➜ ./xbps-src binary-bootstrap</b><br /><br />This will download the appropriate binary packages and install <b>bootstrap</b>.<br /><br />The following directory hierarchy is used with a default configuration file:<br /><br /><pre><b><code>     /void-packages<br />        |- common<br />        |- etc<br />        |- srcpkgs<br />        |  |- xbps<br />        |     |- template<br />        |<br />        |- hostdir<br />        |  |- binpkgs ...<br />        |  |- ccache-&lt;arch&gt; ...<br />        |  |- distcc-&lt;arch&gt; ...<br />        |  |- repocache ...<br />        |  |- sources ...<br />        |<br />        |- masterdir<br />        |  |- builddir -&gt; ...<br />        |  |- destdir -&gt; ...<br />        |  |- host -&gt; bind mounted from &lt;hostdir&gt;<br />        |  |- void-packages -&gt; bind mounted from &lt;void-packages&gt;</code></b></pre><pre><code>&nbsp;</code></pre>The description of these directories is as follows:<br /><ul><li><b><code>masterdir</code></b>: master directory to be used as rootfs to build/install packages.</li><li><b><code>builddir</code></b>: to unpack package source tarballs and where packages are built.</li><li><b><code>destdir</code></b>: to install packages, aka <b>fake destdir</b>.</li><li><b><code>hostdir/ccache</code></b>: to store ccache data if the <code>XBPS_CCACHE</code> option is enabled.</li><li><b><code>hostdir/distcc-&lt;arch&gt;</code></b>: to store distcc data if the <code>XBPS_DISTCC</code> option is enabled.</li><li><b><code>hostdir/repocache</code></b>: to store binary packages from remote repositories.</li><li><b><code>hostdir/sources</code></b>: to store package sources.</li><li><b><code>hostdir/binpkgs</code></b>: local repository to store generated binary packages.</li></ul><br />The chroot and bind mount of the build environment needs to be managed:<br /><br /><br /><br /><br />➜ echo XBPS_CHROOT_CMD=uchroot &gt;&gt; etc/conf<br />➜ su root<br /># cd /usr/bin<br /># chown root:xbuilder xbps-uchroot<br /># chmod 4750 xbps-uchroot<br /># exit<br />➜ sudo usermod -a -G xbuilder eamxnew oc<br /><br />Now that the build environment has been prepared somewhat, I need to run the <b>xnew</b> tool, which is part of the <b>xtools</b> package. This creates a new build template for the package I want to build.<br /><br />I fill it out as appropriate and then run <b>xgensum</b>, to generate the sha256 checksum on the file. <br />I end up with a template file like this:<br /><br />&nbsp;&nbsp; 1 # Template file for 'rtaudio'<br />&nbsp; 2 pkgname=rtaudio<br />&nbsp; 3 version=5.0.0<br />&nbsp; 4 revision=1<br />&nbsp; 5 #wrksrc=<br />&nbsp; 6 #create_wrksrc=yes<br />&nbsp; 7 #only_for_archs="i686 x86_64"<br />&nbsp; 8 build_style=gnu-configure<br />&nbsp; 9 #configure_args=""<br />&nbsp;10 #make_build_args=""<br />&nbsp;11 #make_install_args=""<br />&nbsp;12 #conf_files=""<br />&nbsp;13 #make_dirs="/var/log/dir 0755 root root"<br />&nbsp;14 hostmakedepends=""<br />&nbsp;15 makedepends=""<br />&nbsp;16 depends=""<br />&nbsp;17 short_desc="C++ classes that provide a common API for realtime audio input"<br />&nbsp;18 maintainer="Eamonn Costello "<br />&nbsp;19 license="GPL-3.0-or-later"<br />&nbsp;20 homepage="http://www.music.mcgill.ca/~gary"<br />&nbsp;21 distfiles="${homepage}/${pkgname}/release/${pkgname}-${version}.tar.gz"<br />&nbsp;22 checksum=799deae1192da52cc2c15a078ed3b42449580be7d096fe9bc841c5bba0289c57<br /><br /><br /><br />To build rtaudio manually doenload the binary from http://www.music.mcgill.ca/~gary/rtaudio/<br /><br />then run ./configure<br />then make<br /><br /><br />https://github.com/void-linux/void-packages